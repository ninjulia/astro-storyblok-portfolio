//* Generate Accessible Color Sets
//* Import the Sass file generated by a11y-color-tokens
@use '../../_theme/color-tokens' as *;

//todo: add button / link colors, hover styles
:root {
	//* Include the generated CSS custom properties
	@include color-tokens();
	color-scheme: light dark;

	//* Sets defaults to 'light' theme
	--background: var(--color-surface-light);
	--text: color-mix(in hsl, var(--color-on-surface-light) 40%, hsl(0, 0%, 0%));

	--brand: var(--color-primary);
	--brand-tint: var(--color-primary-tint);
	--brand-shade: var(--color-primary-shade);

	--secondary: var(--color-secondary);
	--secondary-light: var(--color-secondary-tint);
	--secondary-shade: var(--color-secondary-shade);

	--text-subtle: var(--color-dark-tint);
	--text-emphasis: var(--color-dark-shade);

	--accent: var(--brand);

	--link-color: var(--brand);
	--link-color-hover: var(--brand-shade);

	--border-color: var(--text);
	--border-color-subtle: var(--text-subtle);
}

//* Light Theme
@media (prefers-color-scheme: light) {
	:root {
		color-scheme: light;

		--standard-btn-bg: color-mix(in hsl, var(--brand) 50%, var(--text));
		--standard-btn-txt: var(--color-light);
		--standard-btn-hover-bg: var(--brand-shade);
		--standard-btn-hover-txt: var(--color-light);
		--standard-btn-focus-bg: var(--brand);
		--standard-btn-focus-txt: var(--color-light);
		--standard-btn-active-line: var(--brand-shade);
		--standard-btn-disabled-bg: var(--color-light);
		--standard-btn-disabled-txt: var(--color-dark);

		--ghost-btn-border: var(--brand-shade);
		--ghost-btn-txt: var(--brand-shade);
		--ghost-btn-hover-bg: var(--brand-tint);
		--ghost-btn-hover-txt: var(--brand);
		--ghost-btn-active-line: var(--brand);
		--ghost-btn-disabled-txt: var(--color-dark-tint);
	}
}

//* Dark Theme
@media (prefers-color-scheme: dark) {
	:root {
		color-scheme: dark;

		--background: var(--color-surface-dark);
		--text: color-mix(in hsl, var(--color-on-surface-light) 40%, hsl(0, 0%, 100%));

		--brand: var(--color-primary);
		--brand-tint: var(--color-primary-tint);
		--brand-shade: var(--color-primary-shade);

		--secondary: var(--color-secondary);
		--secondary-light: var(--color-secondary-tint);
		--secondary-shade: var(--color-secondary-shade);

		--text-subtle: var(--color-light-tint);
		--text-emphasis: var(--color-light);

		--accent: var(--brand);

		--link-color: var(--brand);
		--link-color-hover: var(--text-emphasis);

		--border-color: var(--text);
		--border-color-subtle: var(--text-subtle);

		--standard-btn-bg: var(--color-light);
		--standard-btn-txt: color-mix(in hsl, var(--brand-shade) 80%, var(--background));
		--standard-btn-hover-bg: var(--brand-tint);
		--standard-btn-hover-txt: var(--brand-shade);
		--standard-btn-focus-bg: var(--brand);
		--standard-btn-focus-txt: var(--color-on-brand-shade);
		--standard-btn-active-line: var(--brand);
		--standard-btn-disabled-bg: var(--color-light);
		--standard-btn-disabled-txt: var(--color-dark);

		--ghost-btn-border: var(--color-light);
		--ghost-btn-txt: var(--color-light);
		--ghost-btn-hover-bg: var(--brand-shade);
		--ghost-btn-hover-txt: var(--color-light);
		--ghost-btn-active-line: var(--brand-tint);
		--ghost-btn-disabled-txt: var(--color-dark-tint);
	}
}

//* Set Themes
@mixin focus-ring {
	outline: 2px solid var(--brand);
	outline-offset: 4px;
}

@mixin contrast-text($start) {
	color: $start;
	filter: invert(1) grayscale(1) brightness(1.3) contrast(999);
	mix-blend-mode: luminosity;
}

html {
	accent-color: var(--color-primary);

	a:not([class]) {
		&:link {
			color: var(--link-color);
		}
		&:visited {
			@include contrast-text(var(--link-color-hover));
		}
		&:hover {
			color: var(--link-color-hover);
		}
		&:focus-visible {
			color: var(--brand);
			@include focus-ring();
		}
		&:active {
			color: var(--text-emphasis);
		}
	}
}

body {
	background-color: var(--background);
	color: var(--text);
}

#site-header,
#site-footer {
	background-color: var(--color-dark);
	color: var(--color-on-dark);
}

@mixin set-surfaces($mode) {
	@media (prefers-color-scheme: $mode) {
		.surface-1 {
			--text-subtle: var(--color-on-#{$mode});
			background-color: var(--color-#{$mode});
			.accent {
				color: color-mix(in hsl, var(--brand) 75%, var(--text));
			}
			.text-light {
				color: var(--text-subtle);
			}
		}

		.surface-2 {
			--text-subtle: var(--color-on-#{$mode}-tint);
			background-color: var(--color-#{$mode}-tint);
			.accent {
				@include contrast-text(var(--brand));
			}
			.text-light {
				color: var(--text-subtle);
			}
		}

		.surface-3 {
			--text-subtle: var(--color-on-#{$mode}-shade);
			background-color: var(--color-#{$mode}-shade);
			.accent {
				color: var(--brand);
			}
			.text-light {
				color: var(--text-subtle);
			}
		}

		$outlier: '';
		$type: '';
		@if $mode == light {
			$outlier: dark;
			$type: shade;
		} @else {
			$outlier: light;
			$type: tint;
		}
		.surface-4 {
			isolation: isolate;
			--text-subtle: var(--color-on-#{$outlier}-#{$type});
			background-color: var(--color-#{$outlier}-#{$type});
			color: var(--color-on-#{$outlier}-#{$type});
			.accent {
				color: var(--brand-shade);
			}
			.text-light {
				@include contrast-text(var(--color-on-#{$outlier}-#{$type}));
			}
		}
	}
}

@include set-surfaces('light');
@include set-surfaces('dark');
